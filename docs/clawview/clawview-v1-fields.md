# ClawView v1 字段说明（Display-Only）

> 目标：让用户看懂 OpenClaw 当前运行状态，不提供反向操作。

## 0. 全局约定
- 主时间窗口：**Rolling 24h**
- 辅时间窗口：**Asia/Tokyo 当日**
- 刷新目标：看板数据延迟 **≤ 15 分钟**

---

## 1. P0 必选字段（首版必须展示）

### A. 系统健康
1. **运行状态**（running / degraded / down）
2. **连续运行时长**（uptime）
3. **24h 重启总数**
4. **24h 计划内重启数**（Planned）
5. **24h 异常重启数**（Unexpected）
6. **24h 未知重启数**（Unknown）
7. **最近一次重启时间**
8. **最近一次重启原因**

### B. 定时任务风险（防止触发风暴）
9. **定时任务总数**
10. **已启用任务数**
11. **24h 触发总次数**
12. **Tokyo 今日触发总次数**
13. **单任务 24h 最高触发次数**
14. **触发最多任务 Top5**（任务名 + 次数）

### C. 对外 API 调用（统一抽象）
15. **调用平台**（如 Lark / Discord / GitHub）
16. **接口分组**（endpoint_group）
17. **Tokyo 今日调用次数**
18. **24h 调用次数**
19. **成功次数**
20. **失败次数**
21. **限速次数（429）**
22. **错误率**（失败/总调用）
23. **最近错误时间**
- **限速信号口径说明**：HTTP 429 + 平台等价限流错误统一计入

### D. 错误可见性
24. **当前活跃错误数**
25. **高频错误 Top10**（错误指纹 + 次数）
26. **每个高频错误首次出现时间**
27. **每个高频错误最近出现时间**
28. **近 1 小时错误增速**

### E. 基础规模（轻量）
29. **Skill 总数**
30. **频道总数**
31. **24h 活跃线程数**（可先近似）

### F. 数据质量信息
32. **数据更新时间**
33. **数据完整性状态**（完整 / 部分缺失 / 延迟）
34. **统计口径标记**（Rolling 24h / Tokyo 当日）

---

## 2. P1 可选字段（第二阶段）
1. API 调用延迟 P95 / P99
2. Top Caller（按 job/hook/session）
3. 工具调用错误分布（tool error breakdown）
4. 每小时触发热力图（cron/API）

---

## 3. 展示建议（人话优先）
- 使用中文名词，不直接展示代码字段名。

### 3.1 首页 Dashboard（固定模块）
- 首页固定为 5 个模块：
  1) 健康总览（1 行）
  2) 趋势图（2 张：触发趋势、API/限速趋势）
  3) Skill 摘要（TopN）
  4) Cron 摘要（TopN）
  5) API 摘要（TopN）
- 首页不展示全量列表，不展示周/月长周期明细。

### 3.2 首页调用次数口径（固定）
- 主口径：**Rolling 24h 调用次数**
- 辅口径：**Asia/Tokyo 今日调用次数**
- 周/月调用次数：仅在 **API 详情页** 展示

### 3.3 子模块详情页（承载明细）
- Skill/Cron/API/Error 四个子模块承载完整列表和明细分析。
- TopN 之外的内容必须下钻查看。

---

## 4. 告警阈值（v1 建议）
- 单任务 24h 触发 >= 100：黄灯
- 单任务 24h 触发 >= 300：红灯
- 限速比例（429） >= 5%：黄灯
- 限速比例（429） >= 15%：红灯
- 异常重启 >= 2 次/24h：黄灯
- 异常重启 >= 5 次/24h：红灯

---

## 5. 保留策略（已确认）
- 原始快照：保留 **48h**
- 每日压缩快照：长期保留
- 超过 48h 的 raw 自动清理
